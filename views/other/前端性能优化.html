<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端性能优化 | 一颗石子激起的浪花</title>
    <meta name="description" content="经不住流年似水，逃不过此间少年">
    <link rel="icon" href="/me.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.92830278.css" as="style"><link rel="preload" href="/assets/js/app.6c43a8ba.js" as="script"><link rel="preload" href="/assets/js/4.c3bde6d6.js" as="script"><link rel="preload" href="/assets/js/1.0b311d40.js" as="script"><link rel="preload" href="/assets/js/50.f0b6ecad.js" as="script"><link rel="prefetch" href="/assets/js/10.22efda82.js"><link rel="prefetch" href="/assets/js/11.122508c3.js"><link rel="prefetch" href="/assets/js/12.4e32ad98.js"><link rel="prefetch" href="/assets/js/13.bf84d324.js"><link rel="prefetch" href="/assets/js/14.5c5b7f74.js"><link rel="prefetch" href="/assets/js/15.84f9dd89.js"><link rel="prefetch" href="/assets/js/16.c612419e.js"><link rel="prefetch" href="/assets/js/17.594239d1.js"><link rel="prefetch" href="/assets/js/18.39405176.js"><link rel="prefetch" href="/assets/js/19.46b55618.js"><link rel="prefetch" href="/assets/js/20.6483f6bd.js"><link rel="prefetch" href="/assets/js/21.28ffff2c.js"><link rel="prefetch" href="/assets/js/22.e987c6c0.js"><link rel="prefetch" href="/assets/js/23.f5cf285c.js"><link rel="prefetch" href="/assets/js/24.bd39e29b.js"><link rel="prefetch" href="/assets/js/25.653be34d.js"><link rel="prefetch" href="/assets/js/26.c1b49b41.js"><link rel="prefetch" href="/assets/js/27.545a7557.js"><link rel="prefetch" href="/assets/js/28.19c7c106.js"><link rel="prefetch" href="/assets/js/29.71d8f226.js"><link rel="prefetch" href="/assets/js/30.ce44c73e.js"><link rel="prefetch" href="/assets/js/31.6967c391.js"><link rel="prefetch" href="/assets/js/32.9d62c420.js"><link rel="prefetch" href="/assets/js/33.610c3395.js"><link rel="prefetch" href="/assets/js/34.ea085f19.js"><link rel="prefetch" href="/assets/js/35.1ca64446.js"><link rel="prefetch" href="/assets/js/36.0a94a6a3.js"><link rel="prefetch" href="/assets/js/37.0cb5d3f8.js"><link rel="prefetch" href="/assets/js/38.90a1b6d5.js"><link rel="prefetch" href="/assets/js/39.f3a9682f.js"><link rel="prefetch" href="/assets/js/40.6ccfb534.js"><link rel="prefetch" href="/assets/js/41.60780922.js"><link rel="prefetch" href="/assets/js/42.ee67625a.js"><link rel="prefetch" href="/assets/js/43.279eedf9.js"><link rel="prefetch" href="/assets/js/44.c03b7fa9.js"><link rel="prefetch" href="/assets/js/45.6dc104ac.js"><link rel="prefetch" href="/assets/js/46.3675ee32.js"><link rel="prefetch" href="/assets/js/47.69b2af5f.js"><link rel="prefetch" href="/assets/js/48.36f2e381.js"><link rel="prefetch" href="/assets/js/49.1944fc1b.js"><link rel="prefetch" href="/assets/js/5.b86013de.js"><link rel="prefetch" href="/assets/js/51.e23cb380.js"><link rel="prefetch" href="/assets/js/52.b18c3dd4.js"><link rel="prefetch" href="/assets/js/53.19ede3ff.js"><link rel="prefetch" href="/assets/js/54.302f4a46.js"><link rel="prefetch" href="/assets/js/55.a847db5c.js"><link rel="prefetch" href="/assets/js/56.46a883a5.js"><link rel="prefetch" href="/assets/js/57.dbc23a94.js"><link rel="prefetch" href="/assets/js/58.6932db49.js"><link rel="prefetch" href="/assets/js/59.53e8939e.js"><link rel="prefetch" href="/assets/js/6.a3bcf7c4.js"><link rel="prefetch" href="/assets/js/60.3b3d2f9b.js"><link rel="prefetch" href="/assets/js/61.e43c6f36.js"><link rel="prefetch" href="/assets/js/62.583652e3.js"><link rel="prefetch" href="/assets/js/63.e8860641.js"><link rel="prefetch" href="/assets/js/64.13ebc5ad.js"><link rel="prefetch" href="/assets/js/65.e9c8e7ea.js"><link rel="prefetch" href="/assets/js/66.fa52a850.js"><link rel="prefetch" href="/assets/js/67.f706d6af.js"><link rel="prefetch" href="/assets/js/7.01e04509.js"><link rel="prefetch" href="/assets/js/8.b66213d7.js"><link rel="prefetch" href="/assets/js/9.f05367e5.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f9b1147b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.92830278.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/photo.png" alt="一颗石子激起的浪花" class="logo"> <span class="site-name">一颗石子激起的浪花</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  HOME
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/react.html" class="nav-link"><i class="iconfont undefined"></i>
  react
</a></li><li class="dropdown-item"><!----> <a href="/category/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/category/Egret.html" class="nav-link"><i class="iconfont undefined"></i>
  Egret
</a></li><li class="dropdown-item"><!----> <a href="/category/前端基础.html" class="nav-link"><i class="iconfont undefined"></i>
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/category/拓展.html" class="nav-link"><i class="iconfont undefined"></i>
  拓展
</a></li><li class="dropdown-item"><!----> <a href="/category/RN.html" class="nav-link"><i class="iconfont undefined"></i>
  RN
</a></li><li class="dropdown-item"><!----> <a href="/category/tool.html" class="nav-link"><i class="iconfont undefined"></i>
  tool
</a></li><li class="dropdown-item"><!----> <a href="/category/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/hobby/" class="nav-link"><i class="iconfont reco-document"></i>
  诗和远方
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  短文
</a></div><div class="nav-item"><a href="/link/" class="nav-link"><i class="iconfont reco-other"></i>
  拓展
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      CONTACT
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yangxiansheng1992" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/thomas-yang-github/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/6dfa7cc0b6b5" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/hobby/wechat.html" class="nav-link"><i class="iconfont reco-wechat"></i>
  微信公众号
</a></li><li class="dropdown-item"><!----> <a href="https://freecodecamp.cn/yangxiansheng1992" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  freecodecamp
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/u/yang-xian-sheng-e/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  leetcode-cn
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://codepen.io/dashboard/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  codepen
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  HOME
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/react.html" class="nav-link"><i class="iconfont undefined"></i>
  react
</a></li><li class="dropdown-item"><!----> <a href="/category/css.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/category/Egret.html" class="nav-link"><i class="iconfont undefined"></i>
  Egret
</a></li><li class="dropdown-item"><!----> <a href="/category/前端基础.html" class="nav-link"><i class="iconfont undefined"></i>
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/category/拓展.html" class="nav-link"><i class="iconfont undefined"></i>
  拓展
</a></li><li class="dropdown-item"><!----> <a href="/category/RN.html" class="nav-link"><i class="iconfont undefined"></i>
  RN
</a></li><li class="dropdown-item"><!----> <a href="/category/tool.html" class="nav-link"><i class="iconfont undefined"></i>
  tool
</a></li><li class="dropdown-item"><!----> <a href="/category/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/hobby/" class="nav-link"><i class="iconfont reco-document"></i>
  诗和远方
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  短文
</a></div><div class="nav-item"><a href="/link/" class="nav-link"><i class="iconfont reco-other"></i>
  拓展
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      CONTACT
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yangxiansheng1992" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/thomas-yang-github/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/6dfa7cc0b6b5" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-jianshu"></i>
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/hobby/wechat.html" class="nav-link"><i class="iconfont reco-wechat"></i>
  微信公众号
</a></li><li class="dropdown-item"><!----> <a href="https://freecodecamp.cn/yangxiansheng1992" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  freecodecamp
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/u/yang-xian-sheng-e/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  leetcode-cn
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://codepen.io/dashboard/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  codepen
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#前言" class="sidebar-link">前言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#浏览器缓存" class="sidebar-link">浏览器缓存</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用-http2" class="sidebar-link">使用 HTTP2</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#资源打包压缩" class="sidebar-link">资源打包压缩</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#压缩-js-代码" class="sidebar-link">压缩 JS 代码</a></li><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#压缩-html-代码" class="sidebar-link">压缩 HTML 代码</a></li><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#压缩-css-代码" class="sidebar-link">压缩 CSS 代码</a></li></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#图片资源优化" class="sidebar-link">图片资源优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#不要在-html-里缩放图像" class="sidebar-link">不要在 HTML 里缩放图像</a></li><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用雪碧图（css-sprite）" class="sidebar-link">使用雪碧图（CSS Sprite）</a></li><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用字体图标（iconfont）" class="sidebar-link">使用字体图标（iconfont）</a></li><li class="sidebar-sub-header"><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用-webp" class="sidebar-link">使用 WebP</a></li></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用-cdn" class="sidebar-link">使用 CDN</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#使用预加载" class="sidebar-link">使用预加载</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#dom-渲染层与-gpu-硬件加速" class="sidebar-link">DOM 渲染层与 GPU 硬件加速</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#重排与重绘" class="sidebar-link">重排与重绘</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#优化策略" class="sidebar-link">优化策略</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#pc-端" class="sidebar-link">PC 端</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#移动端" class="sidebar-link">移动端</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html#传统页面和单页" class="sidebar-link">传统页面和单页</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>前端性能优化</h1> <hr> <div data-v-362e684e><i class="iconfont reco-account" data-v-362e684e><span data-v-362e684e>Thomas</span></i> <i class="iconfont reco-date" data-v-362e684e><span data-v-362e684e>2019-10-16</span></i> <span id="/views/other/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-2e99e05a data-v-362e684e><i class="iconfont reco-eye" style="margin-right: .5rem" data-v-2e99e05a></i> <a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;" data-v-2e99e05a></a></span> <i class="iconfont reco-tag tags" data-v-362e684e><span class="tag-item" data-v-362e684e>
      拓展
    </span></i></div></div> <div class="content__default"><h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <p>我们先来看一下页面渲染流程图，每个阶段的用时可以在 performance.timing 里查询。</p> <img src="/image/other/performance.png" style="width:100%;display:block;margin:0 auto;"> <p>从图中我们可以看出，浏览器在得到用户请求之后，经历了下面这些阶段：重定向 → 拉取缓存 → dns 查询 → 建立 tcp 连接 → 发起请求 → 接收响应 → 处理 html 元素 → 元素加载完成。</p> <ul><li>网络传输性能优化
<ul><li>浏览器缓存</li> <li>使用 http2</li> <li>资源打包压缩
<ul><li>js 压缩</li> <li>html 压缩</li> <li>css 压缩</li></ul></li> <li>图片资源优化
<ul><li>不要在 html 里缩放图像</li> <li>使用雪碧图（css sprite）</li> <li>使用字体图标（iconfont）</li> <li>使用 webp</li></ul></li> <li>使用 cdn</li> <li>使用预加载</li></ul></li> <li>页面渲染性能优化
<ul><li>浏览器渲染过程（webkit）</li> <li>dom 渲染层与 gpu 硬件加速</li> <li>重排与重绘</li></ul></li> <li>其他优化
<ul><li>pc 端</li> <li>移动端</li> <li>前后端同构</li></ul></li></ul> <h1 id="网络传输性能优化"><a href="#网络传输性能优化" aria-hidden="true" class="header-anchor">#</a> 网络传输性能优化</h1> <p>我们常将网络性能优化措施归结为三大方面：<strong>减少请求数、减小请求资源大小、提升网络传输速率.</strong></p> <h2 id="浏览器缓存"><a href="#浏览器缓存" aria-hidden="true" class="header-anchor">#</a> 浏览器缓存</h2> <p>浏览器在向服务器发起请求前，会先查询本地是否有相同的文件，如果有，就会直接拉取本地缓存，我们先看看浏览器处理缓存的策略。
<img src="/image/other/performance-cache.png" style="width:100%;display:block;margin:0 auto;"></p> <p>浏览器默认的缓存是放在内存中的，但内存里的缓存会因为进程的结束或者说浏览器的关闭而被清除，如果存在硬盘里就能够被长期保留下去。很多时候，我们在 network 面板中各请求的 size 项里，会看到两种不同的状态：from memory cache 和 from disk cache，前者指缓存来自内存，后者指缓存来自硬盘。而控制缓存存放位置的是我们在服务器上设置的 etag 字段。在浏览器接收到服务器响应后，会检测响应头部，如果有 etag 字段，那么浏览器就会将本次缓存写入硬盘中。</p> <h2 id="使用-http2"><a href="#使用-http2" aria-hidden="true" class="header-anchor">#</a> 使用 HTTP2</h2> <p>我们都知道，在一次 http 请求中，底层会通过 tcp 建立连接。而 tcp 协议存在 3 次握手，4 次挥手阶段，这些机制保证了 tcp 的可靠性，但降低了传输效率，为了解决这个问题，我们可以使用 http2 来增加传输时候效率。</p> <p>http2 相比 http1 主要有以下几点优化：</p> <ul><li>多路复用
<ul><li>多个 http 复用一个 tcp 连接，减少 tcp 握手时间。</li></ul></li> <li>压缩头部
<ul><li>常用的头部字段保存在表里，传输时只需要传递索引值即可。</li></ul></li> <li>服务器端推送
<ul><li>服务器根据页面内容，主动把页面需要的资源传给客户端，减少请求数。</li></ul></li></ul> <h2 id="资源打包压缩"><a href="#资源打包压缩" aria-hidden="true" class="header-anchor">#</a> 资源打包压缩</h2> <p>我们之前所作的浏览器缓存工作，只有在用户第二次访问我们的页面才能起到效果，如果要在用户首次打开页面就实现优良的性能，必须对资源进行优化。</p> <h3 id="压缩-js-代码"><a href="#压缩-js-代码" aria-hidden="true" class="header-anchor">#</a> 压缩 JS 代码</h3> <p>在 webpack 的 production 模式中，会自动压缩 js 代码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      sourceMap<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// set to true if you want JS source maps</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>Plugins
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="压缩-html-代码"><a href="#压缩-html-代码" aria-hidden="true" class="header-anchor">#</a> 压缩 HTML 代码</h3> <p>使用 html-webpack-plugin 中的 minify 进行压缩。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    removeRedundantAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    useShortDoctype<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    removeEmptyAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    removeStyleLinkTypeAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    keepClosingSlash<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minifyURLs<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  chunksSortMode<span class="token punctuation">:</span> <span class="token string">'dependency'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="压缩-css-代码"><a href="#压缩-css-代码" aria-hidden="true" class="header-anchor">#</a> 压缩 CSS 代码</h3> <p>使用 cssnano 压缩 css。在 postcss.config.js 中进行配置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cssnano <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>cssnano<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="图片资源优化"><a href="#图片资源优化" aria-hidden="true" class="header-anchor">#</a> 图片资源优化</h2> <p>刚刚我们介绍了资源打包压缩，只是停留在了代码层面，而在我们实际开发中，真正占用了大量网络传输资源的，并不是这些文件，而是图片，如果你对图片进行了优化工作，你就能立刻看见明显的效果。</p> <h3 id="不要在-html-里缩放图像"><a href="#不要在-html-里缩放图像" aria-hidden="true" class="header-anchor">#</a> 不要在 HTML 里缩放图像</h3> <p>很多开发者可能会有这样的错觉，为了能让用户觉得图片更加清晰，本来为了显示 200x200 的图片，却使用 400x400 的图片，其实不然，在普通的显示器上，用户并不会感到缩放后的大图更加清晰，但这样做会导致网页加载时间变长，同时照成带宽浪费。所以，当你需要用多大的图片时，就在服务器上准备好多大的图片，尽量固定图片尺寸。</p> <blockquote><p>你可能不知道，一张 200KB 的图片和 2M 的图片的传输时间会是 200m 和 12s 的差距。</p></blockquote> <h3 id="使用雪碧图（css-sprite）"><a href="#使用雪碧图（css-sprite）" aria-hidden="true" class="header-anchor">#</a> 使用雪碧图（CSS Sprite）</h3> <p>雪碧图的概念大家一定在生活中经常听见，其实雪碧图是减小请求数的显著运用。而且很奇妙的是，多张图片聘在一块后，总体积会比之前所有图片的体积之和小。这个网站可以生成<a href="https://www.toptal.com/developers/css/sprite-generator" target="_blank" rel="noopener noreferrer">雪碧图<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>;</p> <h3 id="使用字体图标（iconfont）"><a href="#使用字体图标（iconfont）" aria-hidden="true" class="header-anchor">#</a> 使用字体图标（iconfont）</h3> <p>不论是压缩后的图片，还是雪碧图，终归还是图片，只要是图片，就还是会占用大量网络传输资源。但是字体图标的出现，却让前端开发者看到了另外一个神奇的世界。</p> <p>图片能做的很多事情，字体都能作，而且它只是往 html 里插入字符和 css 样式而已，资源占用和图片请求比起来小太多了。</p> <h3 id="使用-webp"><a href="#使用-webp" aria-hidden="true" class="header-anchor">#</a> 使用 WebP</h3> <p>WebP 格式，是谷歌公司开发的一种旨在加快图片加载速度的图片格式。图片压缩体积大约只有 jpeg 的 2/3，并能节省大量的服务器带宽资源和数据空间。</p> <h2 id="使用-cdn"><a href="#使用-cdn" aria-hidden="true" class="header-anchor">#</a> 使用 CDN</h2> <p>再好的性能优化实例，也必须在 CDN 的支撑下才能到达极致。CDN 原理如下：</p> <ul><li>根据 DNS 找到离你最近的服务器。</li> <li>数据同步策略：热门资源立即同步，不热门数据谁用谁同步</li></ul> <p>执行以下命令查看用户与服务器之间经过的所有路由器：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># linux</span>
<span class="token function">traceroute</span> baidu.com
<span class="token comment"># windows</span>
tracert baidu.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>不言而喻，用户和服务器之间距离越远，经过的路由器越多，延迟也就越高。使用 CDN 的目的之一便是解决这一问题，当然不仅仅如此，CDN 还可以分担 IDC（互联网数据中心） 压力。</p> <h2 id="使用预加载"><a href="#使用预加载" aria-hidden="true" class="header-anchor">#</a> 使用预加载</h2> <p>在 html 加载时，会加载很多第三方资源，这些资源的优先级是不同的，一些重要资源需要提前进行获取，而一些资源可以延迟进行加载。我们可以使用 DNS 预解析，预加载，预渲染来管理页面资源的加载。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- DNS 预解析 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//cdfangyuan.cn<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- 预加载，指明哪些资源是在页面加载完成后即刻需要的，并提前获取--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://example.com<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- 预渲染，提前加载下一页的数据 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>prerender<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://example.com<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h1 id="页面渲染性能优化"><a href="#页面渲染性能优化" aria-hidden="true" class="header-anchor">#</a> 页面渲染性能优化</h1> <p>网络层面的优化介绍完了，接下来我们来介绍一下页面渲染时的优化。</p> <img src="/image/other/performance-render.png" style="width:100%;display:block;margin:0 auto;"> <ul><li>parseHTML。解析 html，并构建 dom 树。</li> <li>在解析过程中遇到 link 标记，引用外部的 css 文件。
<ul><li>Recalculate Style。将 css 文件解析成 css 对象模型(cssom)。</li></ul></li> <li>Composite Layers。将 dom 和 cssom 合并成一个渲染树。
<ul><li>将 display：none 的元素从渲染树中删除掉。</li> <li>获取 dom 树，并根据样式将其分割成多个独立的渲染层。</li></ul></li> <li>Layout。根据渲染树进行重排。
<ul><li>精确地捕获每个元素在视口内的确切位置和尺寸，所有相对像素都会转换为屏幕上的绝对像素。</li> <li>cpu 将每个渲染层绘制进位图中。</li> <li>将位图作为纹理上传至 gpu 绘制。</li></ul></li> <li>Paint。将各个节点绘制到屏幕上。
<ul><li>这一步通常称为“绘制”或“栅格化”。</li> <li>将 csssom 中的每个节点转换成屏幕上的实际像素。</li> <li>gpu 缓存渲染层，并复合多个渲染层，最终形成我们的图像。</li></ul></li></ul> <h2 id="dom-渲染层与-gpu-硬件加速"><a href="#dom-渲染层与-gpu-硬件加速" aria-hidden="true" class="header-anchor">#</a> DOM 渲染层与 GPU 硬件加速</h2> <p>一个页面在构建完 render tree 之后，是经历了这样的流程才最终呈现在我们面前的：</p> <ul><li>浏览器会先获取 dom 树并依据样式将其分割成多个独立的渲染层。</li> <li>cpu 将每个层绘制进位图中。</li> <li>将位图作为纹理上传至 gpu（显卡）绘制。</li> <li>gpu 将所有的渲染层缓存（如果下次上传的渲染层没有发生变化，gpu 就不需要对其进行重绘）并复合多个渲染层最终形成我们的图像。</li></ul> <p>从上面的步骤我们可以知道，布局是由 cpu 处理的，而绘制则是由 gpu 完成的。</p> <p>我们可以利用<strong>gpu 缓存来减少页面重绘</strong>，例如：把那些一直发生大量重排重绘的元素提取出来，单独触发一个渲染层，那样这个元素就<strong>不会影响其他层</strong>一块重绘了。</p> <p>什么情况下会触发渲染层呢？</p> <p>video 元素、canvas、css3d、css 滤镜、z-index 大于某个相邻节点的元素都会触发新的渲染层，最常用的方法，就是给某个元素加上下面的样式：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>我们把容易触发重排重绘的元素单独触发渲染层，让它与那些“静态”元素隔离，让<strong>gpu 分担更多的渲染工作</strong>，我们通常把这样的措施称为硬件加速，或者是 gpu 加速。</p> <h2 id="重排与重绘"><a href="#重排与重绘" aria-hidden="true" class="header-anchor">#</a> 重排与重绘</h2> <ul><li>重排（reflow）：渲染层内的元素布局发生修改，都会导致页面重新排列，比如窗口的尺寸发生变化、删除或添加 DOM 元素，修改了影响元素盒子大小的 css 属性（诸如：width、height、padding）。</li> <li>重绘（repaint）：绘制，即渲染上色，所有对元素的视觉表现属性的修改，都会引发重绘。</li></ul> <p>不论是重排还是重绘，都会阻塞浏览器。要提高网页性能，就要降低重排和重绘的频率和成本，近可能少地触发重新渲染。重排是由 cpu 处理的，而重绘是由 gpu 处理的，cpu 的处理效率远不及 gpu，并且重排一定会引发重绘，而重绘不一定会引发重排。所以在性能优化工作中，我们更应当着重减少重排的发生。</p> <p>这里给大家推荐一个网站，里面详细列出了哪些 css 属性在不同的渲染引擎中是否会触发重排或重绘：<a href="https://csstriggers.com/" target="_blank" rel="noopener noreferrer">cssTriggers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="优化策略"><a href="#优化策略" aria-hidden="true" class="header-anchor">#</a> 优化策略</h2> <p>谈了那么多理论，最实际不过的，就是解决方案，大家一定都等着急了吧，做好准备，一大波干货来袭：</p> <ul><li>css 属性读写分离，浏览器每次对元素样式进行读操作时，都必须进行一次重新渲染（重排 + 重绘），所以我们在使用 js 对元素样式进行读写操作时，最好将两者分离开，先读后写，避免出现两者交叉使用的情况。最客观的解决方案，就是不用 js 去操作元素样式。</li> <li>批量修改样式，通过切换 class 或者 style.csstext 属性去批量操作元素样式。</li> <li>dom 元素离线更新，当对 dom 进行相关操作时，例如 innerHTML、appendChild 等都可以使用 documentFragment 对象进行离线操作，带元素“组装”完成后再一次插入页面，或者使用 display:none 对元素隐藏，在元素“消失”后进行相关操作。</li> <li>将没用的元素设为不可见，visibility: hidden，这样可以减小重绘的压力，必要的时候再将元素显示。</li> <li>减少 dom 的深度，一个渲染层内不要有过深的子元素，少用 dom 完成页面样式，多使用伪元素或者 box-shadow 取代。</li> <li>在渲染前指定图片大小，因为 img 元素是内联元素，所以在加载图片后会改变宽高，严重的情况会导致整个页面重排，所以最好在渲染前就指定其大小，或者让其脱离文档流。</li> <li>合理使用硬件加速，对页面中可能发生大量重排重绘的元素单独触发渲染层，使用 gpu 分担 cpu 压力。（这项策略需要慎用，得着重考量以牺牲 gpu 占用率能否换来可期的性能优化，毕竟页面中存在太多的渲染层对与 gpu 而言也是一种不必要的压力，通常情况下，我们会对动画元素采取硬件加速。）</li></ul> <h1 id="其他优化"><a href="#其他优化" aria-hidden="true" class="header-anchor">#</a> 其他优化</h1> <h2 id="pc-端"><a href="#pc-端" aria-hidden="true" class="header-anchor">#</a> PC 端</h2> <ul><li>同一个域名下 3 个 js。</li> <li>整个网页首屏加载的 js 5 个。</li> <li>gzip 之后每个文件大小不超过 31.2KB~ 最大 100。</li></ul> <h2 id="移动端"><a href="#移动端" aria-hidden="true" class="header-anchor">#</a> 移动端</h2> <ul><li>使用 manifest 配置离线应用。</li> <li>利用 localstrage 缓存数据，容量最大 5M ，不能超过 2.5M。
<ul><li>同步，容量小，读取快。</li> <li>localstrage 扩容计划。 iframe + postmessage。</li></ul></li> <li>基于 indexdDB 等异步缓存方案。
<ul><li>容量大，读取慢。</li></ul></li> <li>区分机型 ua，如果机型性能不好，就加载简版页面。</li> <li>网速检测，页面中默认使用 1x 图，如果网速好则用 2x 图。</li></ul> <h2 id="传统页面和单页"><a href="#传统页面和单页" aria-hidden="true" class="header-anchor">#</a> 传统页面和单页</h2> <ul><li>传统页面。
<ul><li>先加载页面骨架，然后 ajax 请求数据，容易白屏。</li></ul></li> <li>传统单页。
<ul><li>利用 ajax 拉去数据，通过 hash 或者 history 管理路由，速度快，seo 不友好。</li></ul></li> <li>前后端同构。
<ul><li>pushstate + ajax，首页进行服务器端渲染，页面内部的跳转由 ajax 获取数据渲染。</li> <li>页面刷新，则直接请求后端，进行服务器端渲染。</li></ul></li></ul> <h1 id="拓展阅读"><a href="#拓展阅读" aria-hidden="true" class="header-anchor">#</a> 拓展阅读</h1> <p><a href="https://juejin.im/post/5b6fa8c86fb9a0099910ac91#comment" target="_blank" rel="noopener noreferrer">网站性能优化实战——从12.67s到1.06s的故事<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Thomas: </span> <span class="time">10/16/2019, 1:33:23 PM</span></div></footer> <!----> </main> <div class="valine-wrapper" data-v-5029e45b><div id="valine" data-v-5029e45b></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-cd623d78 data-v-cd623d78><i class="iconfont reco-up" data-v-cd623d78></i></div></div></div></div><div class="global-ui"><SWUpdatePopup></SWUpdatePopup></div></div>
    <script src="/assets/js/app.6c43a8ba.js" defer></script><script src="/assets/js/4.c3bde6d6.js" defer></script><script src="/assets/js/1.0b311d40.js" defer></script><script src="/assets/js/50.f0b6ecad.js" defer></script>
  </body>
</html>
